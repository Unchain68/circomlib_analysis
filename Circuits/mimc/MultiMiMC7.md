# How does it work

해당 코드는 입력값으로 주어지는 nInputs 개수의 신호에 대해 MiMC7 알고리즘을 적용하여 출력값을 계산하는 MultiMiMC7 템플릿을 정의하고 있습니다.

입력값으로는 nInputs 개수의 신호 in과 상수 k가 사용되며, 출력값으로는 신호 out이 사용됩니다. 또한, 계산에 필요한 내부 변수로는 신호 r이 사용됩니다.

템플릿 내부에서는 각 입력 신호마다 MiMC7 컴포넌트를 생성하여 사용하며, k와 이전 라운드에서 계산된 r값, 입력 신호 in을 이용하여 현재 라운드의 r값을 계산합니다. 마지막 라운드에서는 계산된 r값을 출력값으로 사용합니다.

이러한 방식으로 입력값으로 주어진 신호들에 대해 MiMC7 알고리즘을 적용하여 출력값을 계산하는 템플릿이 정의되었습니다.

## What is MiMC
MiMC(Mimc Inversion of Cipher) 알고리즘은 암호학 분야에서 사용되는 암호화 함수 중 하나로, 비선형성을 강조하는 함수입니다. 이 함수는 비선형성을 강조하는 비선형 함수와 무작위성을 추가하는 key-mixing 단계로 구성됩니다.

비선형 함수는 일반적으로 스플릿-피스트(Split-Fiestel) 알고리즘을 사용하여 구현됩니다. 이는 입력 데이터를 두 개 이상의 블록으로 분할하고, 이들 블록을 비선형 함수를 통해 변환하는 것을 의미합니다. 이 과정을 여러 번 반복하여 출력 데이터를 생성합니다.

또한 MiMC는 key-mixing 단계를 사용하여 입력 데이터와 키를 결합하는 것으로 무작위성을 추가합니다. 이 과정에서는 입력 데이터와 키를 XOR 연산하고, 다시 비선형 함수를 적용합니다. 이를 여러 번 반복하여 최종 출력을 생성합니다.

따라서 MiMC는 비선형 함수와 무작위성을 결합하여 보안성을 높이는 암호화 함수입니다.

## Split-Fiestel Algorithm 

스플릿-피스트(Split-Fiestel) 알고리즘은 대칭키 암호화에서 많이 사용되는 블록 암호화 방식 중 하나입니다. 스플릿-피스트 알고리즘은 블록 단위로 암호화하는 구조를 가지고 있으며, 블록 단위로 쪼갠 데이터를 반복적으로 바꾸는 과정을 거쳐 암호화를 수행합니다.

일반적으로 스플릿-피스트 알고리즘은 입력 데이터를 두 개로 분리하여 처리합니다. 먼저 입력 데이터를 반으로 쪼갠 다음, 반으로 쪼갠 두 부분을 각각 처리하는 구조를 가지고 있습니다. 이후 두 부분의 결과를 다시 합쳐 최종적인 암호문을 생성합니다.

스플릿-피스트 알고리즘은 주로 Feistel 구조를 사용하여 구현됩니다. Feistel 구조는 입력 데이터를 블록 단위로 나눈 다음, 각 블록을 여러 번 반복적으로 처리하여 암호화하는 방식입니다. 이때, 각 반복에서 입력 데이터의 절반을 가지고 비선형 함수를 적용하고, 나머지 절반에 대해 선형 변환을 수행합니다.

스플릿-피스트 알고리즘의 구체적인 예시를 들어보자면, 입력 데이터를 64비트 블록으로 쪼갠 다음, 32비트씩 두 개의 블록으로 분리합니다. 그리고 이 두 블록을 각각 L과 R이라는 변수에 저장한 후, 이를 반복적으로 처리합니다.

처음에는 L과 R을 각각 믹싱하여 임시 변수 T에 저장합니다. 이후 T에서 비선형 함수 F를 적용하고, 그 결과를 다시 T에 저장합니다. 이때 F 함수는 대부분 S-Box 함수를 사용합니다. 이후 T와 L을 XOR 연산을 수행하여 R을 구하고, 이를 다시 L 변수에 저장합니다. 마지막으로 L과 R을 합쳐 최종적인 암호문을 생성합니다.

스플릿-피스트 알고리즘은 복호화 과정에서도 동일한 알고리즘을 적용하여 복호화를 수행할 수 있습니다. 이때, 암호화와 복호화를 수행할 때 사용하는 키는 동일해야 합니다.

## S-Box함수란?

S-Box 함수는 암호학에서 사용되는 비선형 변환 함수입니다. S-Box 함수는 입력 비트를 다른 비트 패턴으로 매핑하는데 사용됩니다.

보통 S-Box 함수는 블록 암호화의 한 부분으로 사용되며, 입력 블록의 일부분을 대응하는 출력 블록으로 바꿉니다. 이때, S-Box 함수는 암호화 키와 함께 사용되며, 키에 따라 S-Box 함수의 출력이 달라집니다.

S-Box 함수는 비선형 함수로 구성되어 있으므로, 암호화에 있어서 중요한 역할을 합니다. S-Box 함수는 전형적으로 다양한 수학적 연산(예: XOR, AND, OR, 등)을 조합하여 만들어지며, 입력에 대한 출력을 빠르게 계산할 수 있도록 하기 위해 하드웨어 구현이 가능하도록 설계되어 있습니다.

## Round 함수란?
암호학에서 라운드 함수(round function)는 대부분의 블록 암호(block cipher)에서 사용되는 함수입니다. 라운드 함수는 입력으로 받은 평문 블록(plain text block)과 라운드 키(round key)를 사용하여 암호문 블록(cipher text block)을 생성합니다.

블록 암호에서는 블록 크기가 고정되어 있기 때문에, 평문 블록을 여러 개의 블록으로 분할하고 각 블록마다 라운드 함수를 적용하는 과정을 거칩니다. 이 과정을 여러 라운드(round)로 구성하여 전체 암호화를 수행합니다.

라운드 함수는 일반적으로 다양한 암호 기법을 적용하여 구성됩니다. 예를 들어 Feistel 구조에서는 라운드 함수가 총 두 개의 함수로 구성되어 있으며, 반복적으로 적용하여 최종 암호화를 수행합니다. MiMC 알고리즘에서도 라운드 함수가 사용되며, 비선형 함수와 선형 함수를 조합하여 구성됩니다.

## 어느 부분에서 비선형 연산이 이루어 졌는가?
```
        t2[i] <== t*t;
        t4[i] <== t2[i]*t2[i];
        t6[i] <== t4[i]*t2[i];
        if (i<nrounds-1) {
            t7[i] <== t6[i]*t;
        } else {
            out <== t6[i]*t + k;
        }
```
