# How does it work

해당 코드는 MiMC7 알고리즘을 구현한 Circom 템플릿입니다.

첫 번째 줄에서는 nrounds와 x_in을 input signal로 받고, k와 out을 output signal로 받습니다. k는 MiMC7 알고리즘의 키패딩값으로 사용되며, x_in은 입력값입니다. out은 MiMC7 알고리즘을 적용한 결과값으로 출력됩니다.

다음으로, 상수 c가 정의되어 있습니다. 이것은 MiMC7 알고리즘에서 사용하는 상수로, 91개의 값으로 이루어져 있습니다.

그리고, t2, t4, t6, t7이라는 변수가 정의되어 있습니다. 이들은 MiMC7 알고리즘의 수학적 연산을 위해 사용됩니다.

for 루프에서는 nrounds번 반복하며, t라는 변수에 k와 x_in의 값을 더한 값을 할당합니다. 이후, t2, t4, t6, t7을 계산합니다. t2는 t를 제곱한 값이며, t4는 t2의 제곱, t6은 t4와 t2의 곱으로 계산됩니다. 마지막으로, t6과 t를 곱한 값에 k를 더한 값을 out에 할당합니다.

즉, out은 nrounds번의 루프를 거쳐 MiMC7 알고리즘을 적용한 결과값입니다.

이상입니다.
```
template MiMC7(nrounds) {
    signal input x_in;
    signal input k;
    signal output out;

    var c[91] = [
        0,
        20888961410941983456478427210666206549300505294776164667214940546594746570981,
        ...
        ...
        13602139229813231349386885113156901793661719180900395818909719758150455500533
    ];

    var t;
    signal t2[nrounds];
    signal t4[nrounds];
    signal t6[nrounds];
    signal t7[nrounds-1];

    for (var i=0; i<nrounds; i++) {
        t = (i==0) ? k+x_in : k + t7[i-1] + c[i];
        t2[i] <== t*t;
        t4[i] <== t2[i]*t2[i];
        t6[i] <== t4[i]*t2[i];
        if (i<nrounds-1) {
            t7[i] <== t6[i]*t;
        } else {
            out <== t6[i]*t + k;
        }
    }
}
```

## c 값은 노이즈 값인거야 ?

MiMC 알고리즘에서 c 값은 노이즈 값으로 사용되며, 보안성을 높이기 위해 사용됩니다. c 값은 미리 정의된 상수값으로, MiMC 알고리즘의 라운드마다 다른 c 값을 사용하므로 암호화 결과가 예측하기 어렵습니다. c 값을 바꾸면 암호화 결과도 달라지기 때문에, 공격자가 c 값을 알지 못하면 MiMC 알고리즘의 결과를 예측하기가 어렵습니다. 따라서 c 값은 MiMC 알고리즘의 보안성을 높이는 데에 큰 역할을 합니다.

## 이 알고리즘에서 c값이 정확히 어떻게 적용하길래 알기 힘든거지?

MiMC 알고리즘에서 c 값은 라운드 함수에 사용되는 상수입니다. 이 값은 알고리즘의 보안성과 안전성에 매우 중요한 역할을 합니다.

MiMC 알고리즘에서는 c 값이 미세한 노이즈를 생성하는 것과 같은 역할을 수행합니다. c 값이 무작위로 선택되면, 알고리즘이 예측 불가능한 값을 생성하게 되어, 암호학적으로 안전한 결과를 보장할 수 있습니다.

따라서, c 값은 무작위로 생성되거나, 사전 정의된 특정 규칙에 따라 생성될 수 있습니다. 이 코드에서는 c 값을 미리 계산하여 배열에 저장하고 있으며, 라운드 함수에서 c 값이 사용되어 미세한 노이즈를 생성하고 있습니다. 이렇게 생성된 노이즈는 출력값의 예측을 어렵게 만들어, 암호학적으로 안전한 결과를 보장할 수 있습니다.
